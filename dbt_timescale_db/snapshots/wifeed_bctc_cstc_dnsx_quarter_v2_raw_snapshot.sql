{% snapshot wifeed_bctc_cstc_dnsx_quarter_v2_raw_snapshot %}

    {{
        config(
            strategy='check',
            target_schema='snapshots',
            unique_key='unique_id',
            check_cols=['mack', 'type', 'quy', 'nam', 'tsck_nophaitra', 'nodaihan_qoq', 'duphonggiamgiackkd', 'nwc', 'ebit', 'ebitda', 'tylethuesuat', 'nopat', 'bienlaigop', 'bienlaisauthue', 'bienlaiebit', 'bienlaiebitda', 'bienlaitruocthue', 'khauhao_tscd', 'khtscd', 'capex', 'tile_tsdd_nguyengiatscd', 'duphongphaithu_phaithu_dn', 'tile_duphong_gghtk', 'tile_duphong_dttc_daihan', 'vldr', 'vldr_nwc', 'vldr_tsnh', 'vldr_tsdh', 'tt_dtt_yoy', 'tt_lng_yoy', 'tt_ebit_yoy', 'tt_ebitda_yoy', 'tt_lntt_yoy', 'tt_lnst_yoy', 'lnst_yoy', 'ln_hdkd_yoy', 'ln_hdtc_yoy', 'ln_ldlk_yoy', 'ln_khac_yoy', 'cpgiavon_yoy', 'cptaichinh_yoy', 'cpbh_yoy', 'cpqldn_yoy', 'tt_tts', 'tt_tsnh', 'tt_tsdh', 'ttdt_yoy', 'tvtgnh_yoy', 'ckkd_yoy', 'dttc_nganhan_yoy', 'dttc_daihan_yoy', 'cackhoanphaithu_yoy', 'htk_yoy', 'tscd_yoy', 'haomonluyke_yoy', 'bdsdautu_yoy', 'loithethuongmai_yoy', 'duphong_phaithu_yoy', 'tsdd_daihan_yoy', 'tscd_vohinh_yoy', 'duphong_giamgiackkd_yoy', 'duphong_giamgiahtk_yoy', 'duphong_dttc_daihan_yoy', 'tt_no', 'tt_nnh', 'tt_ndh', 'tt_vcsh', 'nguoimuatratruoc_yoy', 'phaitranguoiban_yoy', 'dt_chuathuchien_yoy', 'novay_yoy', 'nochiemdung_yoy', 'thangduvon_yoy', 'cpquy_yoy', 'ln_chuaphanphoi_yoy', 'lctt_hdkd_yoy', 'lctt_hddt_yoy', 'lctt_hdtc_yoy', 'lctt_trongky_yoy', 'khauhao_tscd_yoy', 'capex_yoy', 'dtt_qoq', 'ln_gop_qoq', 'ebit_qoq', 'ebitda_qoq', 'lntt_qoq', 'lnst_ctyme_qoq', 'lnst_qoq', 'ln_hdkd_qoq', 'ln_hdtc_qoq', 'ln_ldlk_qoq', 'ln_khac_qoq', 'cpgiavon_qoq', 'cptaichinh_qoq', 'cpbanhang_qoq', 'cpquanlydn_qoq', 'tongtaisan_qoq', 'tsnganhan_qoq', 'tsdaihan_qoq', 'ttdt_qoq', 'tvtgnh_qoq', 'ckkd_qoq', 'dttc_nganhan_qoq', 'dttc_daihan_qoq', 'cackhoanphaithu_qoq', 'htk_qoq', 'tscd_qoq', 'haomonluyke_qoq', 'bdsdautu_qoq', 'loithethuongmai_qoq', 'duphong_phaithu_qoq', 'tsdd_daihan_qoq', 'tscd_vohinh_qoq', 'duphong_giamgiackkd_qoq', 'duphong_giamgiahtk_qoq', 'duphong_dttc_daihan_qoq', 'tongno_qoq', 'nonganhan_qoq', 'vonchusohuu_qoq', 'nguoimuatratruoc_qoq', 'phaitranguoiban_qoq', 'dt_chuathuchien_qoq', 'novay_qoq', 'nochiemdung_qoq', 'thangduvon_qoq', 'cpquy_qoq', 'lnst_chuaphanphoi_qoq', 'lctt_hdkd_qoq', 'lctt_hddt_qoq', 'lctt_hdtc_qoq', 'lctt_trongky_qoq', 'khauhao_tscd_qoq', 'capex_qoq', 'dol', 'dfl', 'dtl', 'tongno_tongtaisan', 'congnonganhan_tongtaisan', 'congnodaihan_tongtaisan', 'tts_vonchu', 'novay_tts', 'novay_vonchu', 'novayrong_vonchu', 'thanhtoan_hienhanh', 'thanhtoan_nhanh', 'thanhtoan_tienmat', 'tile_chiphigiavon', 'tile_chiphilaivay', 'tile_chiphibanhang', 'tile_chiphiquanly', 'tile_hangmuadiduong', 'tile_nguyenvatlieu', 'tile_congcudungcu', 'tile_chiphisanxuat', 'tile_thanhpham', 'tile_hanghoa', 'tile_hangguidiban', 'tile_hangtonkhokhac', 'tile_hanghoabds', 'tile_loinhuanhoatdongkinhdoanhchinh', 'tile_loinhuantaichinh', 'tile_lailoldlk', 'tile_loinhuankhac', 'tongno_tts_nam', 'congnonganhan_tts_nam', 'congnodaihan_tts_nam', 'tile_nguoimuatratruoc_nv', 'tile_phaitranguoiban_nv', 'tile_doanhthuchuathuchien_nv', 'tile_novay_nv', 'tile_nochiemdung_nv', 'tile_thangduvon_nv', 'tile_cophieuquy_nv', 'tile_loinhuanchuaphanpho_nv', 'tsnh_tts_dn', 'tvtd_tts_dn', 'tgnh_tts_dn', 'tile_ckkd', 'dttcnh_tts_dn', 'dttcdh_tts_dn', 'dttc_tts_dn', 'ckpt_tts_dn', 'htk_tts_dn', 'tscd_tts_dn', 'bdsdt_tts', 'lttm_tts', 'tile_tsdd_daihan', 'tile_tscd_vohinh', 'ncav', 'ncav_ps', 'netcash', 'netcash_ps', 'p_ncav', 'p_ncp', 'p_lnw', 'lnwpershare', 'nc_vh', 'lnw_vh', 'ev', 'vldr_vh', 'vcsh_nguonvon', 'nophaitra_vcsh', 'lnst_ctyme', 'lnst_ctyme_yoy', 'vcsh', 'vcsh_yoy', 'vcsh_qoq', 'lctt_hdkd', 'lctt_hddt', 'lctt_hdtc', 'lntt', 'lntt_yoy', 'nophaitra', 'nophaitra_yoy', 'nophaitra_qoq', 'tts', 'tts_yoy', 'tts_qoq', 'lnst', 'vonhoa', 'bookvalue', 'bvps', 'pb' ],
            invalidate_hard_deletes=True
        )
    }}

select *
from {{ ref('stg_public__wifeed_bctc_cstc_dnsx_quarter_v2_raw') }}
{% endsnapshot %}

